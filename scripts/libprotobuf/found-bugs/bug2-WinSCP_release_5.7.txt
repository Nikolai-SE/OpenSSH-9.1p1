=================================================================
==1858392==ERROR: AddressSanitizer: heap-use-after-free on address 0x612000027940 at pc 0x0000007f6c10 bp 0x7f6be4fdf1d0 sp 0x7f6be4fdf1c8
READ of size 1 at 0x612000027940 thread T7
==1858392==WARNING: Can't write to symbolizer at fd 8
    #0 0x7f6c0f in kex_assemble_names /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/kex.c:234:24
    #1 0x604eaa in assemble_algorithms /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/servconf.c:233:2
    #2 0x6220e3 in copy_set_server_options /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/servconf.c:2658:2
    #3 0x6194d8 in parse_server_match_config /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/servconf.c:2539:2
    #4 0x63d5ff in getpwnamallow /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/auth.c:478:2
    #5 0x6482f2 in input_userauth_request /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/auth2.c:286:18
    #6 0x7ae3dd in ssh_dispatch_run /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/dispatch.c:113:8
    #7 0x7ae6e0 in ssh_dispatch_run_fatal /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/dispatch.c:133:11
    #8 0x641e46 in do_authentication2 /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/auth2.c:177:2
    #9 0x5e92c8 in main_sshd /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/sshd.c:2274:2
    #10 0x573d49 in int std::__invoke_impl<int, int (*)(int, char**), int, char**>(std::__invoke_other, int (*&&)(int, char**), int&&, char**&&) (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x573d49)
    #11 0x573a96 in std::__invoke_result<int (*)(int, char**), int, char**>::type std::__invoke<int (*)(int, char**), int, char**>(int (*&&)(int, char**), int&&, char**&&) (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x573a96)
    #12 0x5739ed in int std::thread::_Invoker<std::tuple<int (*)(int, char**), int, char**> >::_M_invoke<0ul, 1ul, 2ul>(std::_Index_tuple<0ul, 1ul, 2ul>) (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x5739ed)
    #13 0x573944 in std::thread::_Invoker<std::tuple<int (*)(int, char**), int, char**> >::operator()() (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x573944)
    #14 0x57334e in std::thread::_State_impl<std::thread::_Invoker<std::tuple<int (*)(int, char**), int, char**> > >::_M_run() (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x57334e)
    #15 0x7f6bea940ecf  (/lib/x86_64-linux-gnu/libstdc++.so.6+0xceecf)
    #16 0x7f6bea7f7ea6 in start_thread nptl/pthread_create.c:477:8
    #17 0x7f6be9d12a2e in clone misc/../sysdeps/unix/sysv/linux/x86_64/clone.S:95

0x612000027940 is located 0 bytes inside of 266-byte region [0x612000027940,0x612000027a4a)
freed by thread T7 here:
    #0 0x532c6d in free (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x532c6d)
    #1 0x7640bb in compat_kex_proposal /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/compat.c:208:3
    #2 0x5f0b40 in do_ssh2_kex /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/sshd.c:2403:45
    #3 0x5e92bc in main_sshd /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/sshd.c:2273:2
    #4 0x573d49 in int std::__invoke_impl<int, int (*)(int, char**), int, char**>(std::__invoke_other, int (*&&)(int, char**), int&&, char**&&) (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x573d49)
    #5 0x573a96 in std::__invoke_result<int (*)(int, char**), int, char**>::type std::__invoke<int (*)(int, char**), int, char**>(int (*&&)(int, char**), int&&, char**&&) (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x573a96)
    #6 0x5739ed in int std::thread::_Invoker<std::tuple<int (*)(int, char**), int, char**> >::_M_invoke<0ul, 1ul, 2ul>(std::_Index_tuple<0ul, 1ul, 2ul>) (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x5739ed)
    #7 0x573944 in std::thread::_Invoker<std::tuple<int (*)(int, char**), int, char**> >::operator()() (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x573944)
    #8 0x57334e in std::thread::_State_impl<std::thread::_Invoker<std::tuple<int (*)(int, char**), int, char**> > >::_M_run() (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x57334e)
    #9 0x7f6bea940ecf  (/lib/x86_64-linux-gnu/libstdc++.so.6+0xceecf)

previously allocated by thread T7 here:
    #0 0x51ef04 in strdup (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x51ef04)
    #1 0x7f6c51 in kex_assemble_names /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/kex.c:235:17
    #2 0x604eaa in assemble_algorithms /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/servconf.c:233:2
    #3 0x6035e2 in fill_default_server_options /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/servconf.c:448:2
    #4 0x5e424f in main_sshd /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/sshd.c:1786:2
    #5 0x573d49 in int std::__invoke_impl<int, int (*)(int, char**), int, char**>(std::__invoke_other, int (*&&)(int, char**), int&&, char**&&) (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x573d49)
    #6 0x573a96 in std::__invoke_result<int (*)(int, char**), int, char**>::type std::__invoke<int (*)(int, char**), int, char**>(int (*&&)(int, char**), int&&, char**&&) (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x573a96)
    #7 0x5739ed in int std::thread::_Invoker<std::tuple<int (*)(int, char**), int, char**> >::_M_invoke<0ul, 1ul, 2ul>(std::_Index_tuple<0ul, 1ul, 2ul>) (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x5739ed)
    #8 0x573944 in std::thread::_Invoker<std::tuple<int (*)(int, char**), int, char**> >::operator()() (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x573944)
    #9 0x57334e in std::thread::_State_impl<std::thread::_Invoker<std::tuple<int (*)(int, char**), int, char**> > >::_M_run() (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x57334e)
    #10 0x7f6bea940ecf  (/lib/x86_64-linux-gnu/libstdc++.so.6+0xceecf)

Thread T7 created by T0 here:
    #0 0x51d91a in pthread_create (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x51d91a)
    #1 0x7f6bea941144 in std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (/lib/x86_64-linux-gnu/libstdc++.so.6+0xcf144)
    #2 0x56f0e1 in TestOneProtoInput(PacketsData const&) (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x56f0e1)
    #3 0x56ea85 in LLVMFuzzerTestOneInput (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x56ea85)
    #4 0x46c231 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x46c231)
    #5 0x46b975 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x46b975)
    #6 0x46d3a0 in fuzzer::Fuzzer::MutateAndTestOne() (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x46d3a0)
    #7 0x46de15 in fuzzer::Fuzzer::Loop(std::__Fuzzer::vector<fuzzer::SizedFile, fuzzer::fuzzer_allocator<fuzzer::SizedFile> >&) (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x46de15)
    #8 0x45d825 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x45d825)
    #9 0x485472 in main (/home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/scripts/libprotobuf/sshd-libprotobuf-mutator.out+0x485472)
    #10 0x7f6be9c3ad09 in __libc_start_main csu/../csu/libc-start.c:308:16

SUMMARY: AddressSanitizer: heap-use-after-free /home/nik/Fuzzing/OpenSSH/OpenSSH-9.1p1-copy/kex.c:234:24 in kex_assemble_names
Shadow bytes around the buggy address:
  0x0c247fffced0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c247fffcee0: fd fd fd fd fd fd fd fd fd fd fa fa fa fa fa fa
  0x0c247fffcef0: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x0c247fffcf00: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c247fffcf10: fd fd fd fd fd fd fd fd fd fd fa fa fa fa fa fa
=>0x0c247fffcf20: fa fa fa fa fa fa fa fa[fd]fd fd fd fd fd fd fd
  0x0c247fffcf30: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c247fffcf40: fd fd fd fd fd fd fd fd fd fd fa fa fa fa fa fa
  0x0c247fffcf50: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
  0x0c247fffcf60: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c247fffcf70: fd fd fd fd fd fd fd fd fd fd fd fd fd fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==1858392==ABORTING
MS: 5 CustomCrossOver-ChangeBit-Custom-ManualDict-Custom- DE: "WinSCP_release_5.7"-; base unit: ebe37d7155823fdacb8ffdb286c60f63a4c47da6
0x6f,0x70,0x74,0x69,0x6f,0x6e,0x61,0x6c,0x5f,0x73,0x74,0x72,0x69,0x6e,0x67,0x5f,0x63,0x6c,0x69,0x65,0x6e,0x74,0x5f,0x74,0x79,0x70,0x65,0x3a,0x20,0x22,0x57,0x69,0x6e,0x53,0x43,0x50,0x5f,0x72,0x65,0x6c,0x65,0x61,0x73,0x65,0x5f,0x35,0x2e,0x37,0x22,0xa,0x6f,0x70,0x74,0x69,0x6f,0x6e,0x61,0x6c,0x5f,0x75,0x69,0x6e,0x74,0x36,0x34,0x5f,0x75,0x73,0x65,0x72,0x5f,0x69,0x64,0x3a,0x20,0x30,0xa,0x6f,0x70,0x74,0x69,0x6f,0x6e,0x61,0x6c,0x5f,0x73,0x74,0x72,0x69,0x6e,0x67,0x5f,0x75,0x73,0x65,0x72,0x5f,0x6e,0x61,0x6d,0x65,0x3a,0x20,0x22,0x75,0x73,0x65,0x72,0x22,0xa,0x6f,0x70,0x74,0x69,0x6f,0x6e,0x61,0x6c,0x5f,0x73,0x74,0x72,0x69,0x6e,0x67,0x5f,0x75,0x73,0x65,0x72,0x5f,0x70,0x61,0x73,0x73,0x77,0x6f,0x72,0x64,0x3a,0x20,0x22,0x75,0x73,0x65,0x72,0x22,0xa,
optional_string_client_type: \"WinSCP_release_5.7\"\x0aoptional_uint64_user_id: 0\x0aoptional_string_user_name: \"user\"\x0aoptional_string_user_password: \"user\"\x0a
artifact_prefix='./'; Test unit written to ./crash-5820b09a1629849b743051039120fe81c088b3dd
Base64: b3B0aW9uYWxfc3RyaW5nX2NsaWVudF90eXBlOiAiV2luU0NQX3JlbGVhc2VfNS43IgpvcHRpb25hbF91aW50NjRfdXNlcl9pZDogMApvcHRpb25hbF9zdHJpbmdfdXNlcl9uYW1lOiAidXNlciIKb3B0aW9uYWxfc3RyaW5nX3VzZXJfcGFzc3dvcmQ6ICJ1c2VyIgo=
stat::number_of_executed_units: 6
stat::average_exec_per_sec:     3
stat::new_units_added:          1
stat::slowest_unit_time_sec:    0
stat::peak_rss_mb:              52
INFO: exiting: 1 time: 4s
